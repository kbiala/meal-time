app = angular.module("MealTimeModule", ["templates", "ui.router", "ngResource", "satellizer"])

app.config ($stateProvider, $authProvider) ->
  $stateProvider
    .state 'root',
      url: ''
      templateUrl: 'index.html'
      controller: 'MealTimeCtrl'
    .state 'orders',
      parent: 'root'
      url: '/orders'
      template: "<ui-view/>"
      abstract: true
    .state 'orders.index',
      url: '/'
      templateUrl: 'orders/index.html'
      controller: 'OrdersIndexCtrl'
    .state 'orders.show',
      url: '/:id'
      templateUrl: 'orders/show.html'
      controller: 'OrdersShowCtrl'

  $authProvider.github {
    clientId: "<%= ENV['GITHUB_KEY'] %>"
  }

app.factory "orderResource", ($resource) ->
  $resource("/orders/:id", {}, {
    update: {method: "PUT"}
  })

app.factory "mealResource", ($resource) ->
  $resource("/orders/:order_id/meals/:id", {}, {
    update: {method: "PUT"}
  })

app.factory "userResource", ($resource) ->
  $resource("/sessions/:session_id", {}, {})
